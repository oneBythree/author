"use strict";Vue.transition("fadeIn",{enterClass:"fadeIn",leaveClass:"fadeOut"}),Vue.transition("fadeDown",{enterClass:"fadeInDown",leaveClass:"fadeOutUp"});var app=new Vue({el:"#newIndex",data:function(){return{isSearchInLine:!1,cityData:{name:"",pinyin:""},recommendCitys:[],query:"",isAdd:!1,startCity:"",endCity:"",tempSelected:"",filterList:[],addressData:address,showListStart:!0,showListEnd:!0,ajaxStart:"",ajaxEnd:"",commRouters:[],searchData:[]}},ready:function(){this.initData()},methods:{initData:function(){var t=this,a="http://test.haitat.com/api/user/route/main?user=1";$.get(a,{},function(a){if("1"==a.code){var e=sessionStorage.getItem("location");e?(JSON.parse(e).hasOwnProperty("name")?(t.cityData.name=JSON.parse(e).name,t.cityData.pinyin=JSON.parse(e).pinyin):(t.cityData.name="未定位",t.cityData.pinyin="weidingwei"),t.recommendCitys=JSON.parse(e).recommend_city):(a.data.user.location.hasOwnProperty("city")?(t.cityData.name=a.data.user.location.city,t.cityData.pinyin=a.data.user.location.pinyin):(t.cityData.name="未定位",t.cityData.pinyin="weidingwei"),t.recommendCitys=a.data.recommend_city),t.commRouters=a.data.top_lines}else"50010"==a.code&&$.ModuleTip({txt:a.message})})},showSearchInLine:function(){this.isSearchInLine=!0,setTimeout(function(){$("#searchInput").focus()},200)},searchBlur:function(){""!=this.query&&void 0!=this.query||(this.isSearchInLine=!1)},backIndex:function(){this.isSearchInLine=!1,this.query=""},cleanKey:function(){this.query="",$("#searchInput").focus()},searchQueryRouter:function(t){console.log(t)},showAdd:function(){this.isAdd=!0},closeAdd:function(){this.isAdd=!1,this.startCity=this.endCity=""},selectedClick:function(t,a){"start"==a?(this.startCity=t.name,this.ajaxStart=t,this.showListStart=!1):(this.endCity=t.name,this.ajaxEnd=t,this.showListEnd=!1)},input:function(t,a){"start"==a?(this.showListStart=!!t,this.ajaxStart=""):(a="end")&&(this.showListEnd=!!t,this.ajaxEnd="")},blurInput:function(t){var a=this;setTimeout(function(){"start"==t?(a.startCity=""==a.ajaxStart?"":a.startCity,a.showListStart=!1):(a.endCity=""==a.ajaxEnd?"":a.endCity,a.showListEnd=!1)},250)},enter:function(){return!1},linkRouters:function(t){t&&(location.href="http://test.haitat.com/user/routes/"+t)},recommendRoute:function(t){this.linkRouters(t.id);var a=this,e={start:a.cityData.name,end:t.name,start_py:a.cityData.pinyin,end_py:t.pinyin,user:1};a.ajaxAdd(e)},addCommon:function(){var t=this;if(""==t.startCity)return $.ModuleTip({txt:"出发城市不能为空"}),!1;if(""==t.endCity)return $.ModuleTip({txt:"到达城市不能为空"}),!1;if(t.ajaxStart.code==t.ajaxEnd.name)return $.ModuleTip({txt:"出发城市不能为到达城市"}),!1;var a={start:t.ajaxStart.name,end:t.ajaxEnd.name,start_py:t.ajaxStart.namef_full_py,end_py:t.ajaxEnd.namef_full_py,user:1};t.ajaxAdd(a)},searchQuery:function(t){var a=this,e="http://test.haitat.com/api/user/city/suggest",i=(new Date).getTime(),n={q:t,t:i};$.get(e,n,function(t){"1"==t.code?a.searchData=t.data.items:"50010"==t.code&&$.ModuleTip({txt:t.message})})},selectedCity:function(t){if(t){var a=this;t.hasOwnProperty("name")?(a.cityData.name=t.name,a.cityData.pinyin=t.pinyin):(a.cityData.name="未定位",a.cityData.pinyin="weidingwei");var e="http://test.haitat.com/api/user/city/switch",i={city:t.name};$.get(e,i,function(e){"1"==e.code?(a.recommendCitys=e.data.items,t.recommend_city=e.data.items,sessionStorage.setItem("location",JSON.stringify(t))):"50010"==e.code&&$.ModuleTip({txt:e.message})}),this.backIndex()}},ajaxAdd:function(t){var a=this,e="http://test.haitat.com/api/user/route/add";$.get(e,t,function(e){"1"==e.code?a.commRouters.push({start:t.start,end:t.end,id:e.data.id}):"50010"==e.code&&$.ModuleTip({txt:e.message}),a.closeAdd()})}}});